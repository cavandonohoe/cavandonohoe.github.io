---
title: "Google Maps Saved Places"
output:
  html_document:
    includes:
      in_header: header/header.html
      after_body: include_footer.html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

This page embeds my Google My Maps layer and shows the latest exported CSV data from the repo.

## Saved Places

```{=html}
<iframe
  src="https://www.google.com/maps/d/embed?mid=1aSjDN50VR8qKu40GyIE2UsF6C8WzhGU&ehbc=2E312F"
  width="100%"
  height="650"
  style="border:0;"
  loading="lazy">
</iframe>
```

## Latest CSV Export

```{r exported-data}
saved_places_path <- here::here("data", "saved_places.csv")

if (!file.exists(saved_places_path)) {
  cat("`data/saved_places.csv` not found.")
} else {
  saved_places <- readr::read_csv(saved_places_path, show_col_types = FALSE)

  want_to_go <- saved_places |>
    dplyr::filter(layer == "Want to go") |>
    dplyr::select(name, note, url, tags, comment)

  favorites <- saved_places |>
    dplyr::filter(layer == "Favorite places") |>
    dplyr::select(name, note, url, tags, comment)

  cat("### Want to go\n\n")
  want_to_go |>
    DT::datatable(
      filter = "top",
      options = list(pageLength = 10, scrollX = TRUE),
      rownames = FALSE
    )

  cat("\n\n### Favorites\n\n")
  favorites |>
    DT::datatable(
      filter = "top",
      options = list(pageLength = 10, scrollX = TRUE),
      rownames = FALSE
    )
}
```

## Setup Notes

- Add repo secret `MYMAPS_MID` with your My Maps `mid`.
- The weekly workflow updates these files:
  - `data/saved_places.kml`
  - `data/saved_places.csv`
