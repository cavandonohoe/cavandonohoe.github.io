---
title: "Google Maps: Want To Go + Favorites"
output:
  html_document:
    includes:
      in_header: header/header.html
      after_body: include_footer.html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

This page embeds my Google Maps lists and shows the latest exported CSV data from the repo.

## Want To Go

```{=html}
<iframe
  src="https://www.google.com/maps/d/embed?mid=YOUR_WANT_TO_GO_MID"
  width="100%"
  height="600"
  style="border:0;"
  loading="lazy">
</iframe>
```

Source link: <https://maps.app.goo.gl/h3zRvZ1pWLJYHoSN8>

## Favorites

```{=html}
<iframe
  src="https://www.google.com/maps/d/embed?mid=YOUR_FAVORITES_MID"
  width="100%"
  height="600"
  style="border:0;"
  loading="lazy">
</iframe>
```

Source link: <https://maps.app.goo.gl/x5XvtUVNLGtgWFG7A>

## Latest CSV Export

This section loads CSV files in the browser, so table content updates whenever `data/*.csv` changes.

```{=html}
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<h3>Want To Go (CSV)</h3>
<div id="want-to-go-status">Loading...</div>
<div id="want-to-go-table"></div>

<h3>Favorites (CSV)</h3>
<div id="favorites-status">Loading...</div>
<div id="favorites-table"></div>

<script>
function escapeHtml(value) {
  return String(value ?? "")
    .replace(/&/g, "&amp;")
    .replace(/</g, "&lt;")
    .replace(/>/g, "&gt;")
    .replace(/"/g, "&quot;")
    .replace(/'/g, "&#39;");
}

function renderCsvTable(targetId, statusId, csvPath) {
  const statusEl = document.getElementById(statusId);
  const targetEl = document.getElementById(targetId);
  const cacheBuster = Date.now();

  Papa.parse(`${csvPath}?v=${cacheBuster}`, {
    download: true,
    header: true,
    skipEmptyLines: true,
    complete: function(results) {
      const rows = results.data || [];
      if (!rows.length) {
        statusEl.textContent = "No rows found.";
        targetEl.innerHTML = "";
        return;
      }

      const headers = Object.keys(rows[0]);
      const headHtml = headers.map(h => `<th>${escapeHtml(h)}</th>`).join("");
      const bodyHtml = rows.map(row => {
        const cells = headers.map(h => `<td>${escapeHtml(row[h])}</td>`).join("");
        return `<tr>${cells}</tr>`;
      }).join("");

      targetEl.innerHTML = `
        <div style="overflow-x:auto;">
          <table class="table table-striped table-condensed" style="width:100%;">
            <thead><tr>${headHtml}</tr></thead>
            <tbody>${bodyHtml}</tbody>
          </table>
        </div>
      `;
      statusEl.textContent = `Loaded ${rows.length} rows from ${csvPath}.`;
    },
    error: function(err) {
      statusEl.textContent = `Could not load ${csvPath}: ${err.message || err}`;
      targetEl.innerHTML = "";
    }
  });
}

renderCsvTable("want-to-go-table", "want-to-go-status", "data/want_to_go.csv");
renderCsvTable("favorites-table", "favorites-status", "data/favorites.csv");
</script>
```

## Setup Notes

- Add repo secret `MYMAPS_WANT_TO_GO_MID` with your Want To Go My Maps `mid`.
- Add repo secret `MYMAPS_FAVORITES_MID` with your Favorites My Maps `mid`.
- The weekly workflow updates these files:
  - `data/want_to_go.kml`
  - `data/want_to_go.csv`
  - `data/favorites.kml`
  - `data/favorites.csv`
