---
title: "IMDb Rating Plot by Season and Episode"
editor_options: 
  chunk_output_type: console
output:
  html_document:
    includes:
      in_header: header/header.html
      after_body: include_footer.html
    toc: true
    toc_depth: 3
    toc_float:
      collapsed: true
      smooth_scroll: true
---

I'm kinda obsessed with seeing a whole map of series and where they stride well and when they just absolutely fuck different episodes. Sometimes, critics are just a little harsh. Sometimes it's hard to completely crush an entire series, but we can explore some series that figure it out and quite while they're ahead.

```{r setup, include=FALSE}
# Set default chunk output
knitr::opts_chunk$set(
  echo = FALSE, message = FALSE, warning = FALSE,
  results = "asis"
)
```


```{r episode_plot}
library(tidyverse)
library(RColorBrewer)

# Function to create a plot of IMDb ratings by season and episode
create_episode_plot <- function(episode_data, title, export_png = TRUE) {
  file_name <- str_replace_all(tolower(title), " ", "_")
  file_name <- paste0("imdb_rating_plot_files/", file_name, ".png")
  
  episode_plot <- episode_data %>%
    ggplot(aes(x = season, y = episode, fill = imdb_rating,
               text = season_ep_name)) +
    geom_tile(color = "white") +
    geom_text(aes(label = round(imdb_rating, 1)), color = "black") +
    scale_fill_gradientn(
      colors = brewer.pal(9, "RdYlGn"),
      values = scales::rescale(c(0, 4, 6, 8, 10)),
      limits = c(0, 10),
      name = "IMDb Rating"
    ) +
    scale_x_continuous(breaks = seq(min(episode_data$season), max(episode_data$season), 1), position = "top") +
    scale_y_reverse(breaks = seq(min(episode_data$episode), max(episode_data$episode), 1)) +
    labs(title = "IMDb Ratings by Season and Episode", x = "Season", y = "Episode") +
    ggtitle(title) +
    theme_minimal()
  
  if (export_png) {
    ggsave(file_name, plot = episode_plot, width = 8, height = 6, dpi = 300)
  }
  
  return(episode_plot)
}

interactive_plotly = function(gg_object) {
  gg_object %>%
    plotly::ggplotly(tooltip = "text") %>%
    plotly::layout(xaxis = list(side = "top"))
}
```

## Game of Thrones

```{r}
game_of_thrones = read_csv("data/game_of_thrones_ep_ratings.csv")

game_of_thrones %>% create_episode_plot("Game of Thrones") %>% interactive_plotly
```

## Breaking Bad

```{r}
breaking_bad = read_csv("data/breaking_bad_ep_ratings.csv")

breaking_bad %>% create_episode_plot("Breaking Bad") %>% interactive_plotly
```

## Avatar: The Last Airbender

```{r}
avatar = read_csv("data/top250_imdb_series.csv") %>%
  filter(series_name == "Avatar: The Last Airbender") %>%
  mutate(season_ep_name = paste0("S", season, "E", season_ep, ": ", episode)) %>%
  select(season_ep_name, episode = season_ep, season,
         imdb_rating = episode_rating) %>%
  filter(episode != 0)

avatar %>% create_episode_plot("Avatar: The Last Airbender") %>% interactive_plotly
```

## Always Sunny in Philadelphia

```{r}
always_sunny = read_csv("data/always_sunny_ep_ratings.csv")

always_sunny %>% create_episode_plot("Always Sunny in Philadelphia") %>% interactive_plotly
```

## The Office (US)

```{r}
office = read_csv("data/top250_imdb_series.csv") %>%
  filter(series_name == "The Office" & imdb_id == "tt0386676") %>%
  mutate(season_ep_name = paste0("S", season, "E", season_ep, ": ", episode)) %>%
  select(season_ep_name, episode = season_ep, season,
         imdb_rating = episode_rating) %>%
  filter(episode != 0)

office %>% create_episode_plot("The Office (US)") %>% interactive_plotly
```

## HIMYM

```{r}
himym = read_csv("data/himym_ep_ratings.csv")

himym %>% create_episode_plot("How I Met Your Mother") %>% interactive_plotly
```

## Better Call Saul

```{r}
better_call_saul = read_csv("data/better_call_saul_ep_ratings.csv")

better_call_saul %>% create_episode_plot("Better Call Saul") %>% interactive_plotly
```

## ZeroZeroZero

```{r}
zerozerozero = read_csv("data/zerozerozero_ep_ratings.csv")

zerozerozero %>% create_episode_plot("ZeroZeroZero") %>% interactive_plotly
```

## House of the Dragon

```{r}
hotd = read_csv("data/hotd_ep_ratings.csv")

hotd %>% create_episode_plot("House of the Dragon") %>% interactive_plotly
```

## Bluey

```{r fig.height=9, fig.width=4}
bluey = read_csv("data/bluey_ep_ratings.csv")

bluey %>% create_episode_plot("Bluey") %>% interactive_plotly
```

## Westworld

```{r}
westworld = read_csv("data/westworld_ep_ratings.csv")

westworld %>% create_episode_plot("Westworld") %>% interactive_plotly
```

## Paris Hilton's My New BFF

```{r}
paris_hilton_bff = read_csv("data/paris_hilton_bff_ep_ratings.csv")

paris_hilton_bff %>% create_episode_plot("Paris Hilton's My New BFF") %>% interactive_plotly
```

## Stranger Things

```{r}
stranger_things = read_csv("data/stranger_things_ep_ratings.csv")

stranger_things %>% create_episode_plot("Stranger Things") %>% interactive_plotly
```

## Bojack Horseman

```{r}
bojack = read_csv("data/bojack_ep_ratings.csv")

bojack %>% create_episode_plot("Bojack Horseman") %>% interactive_plotly
```

## Velma

```{r}
velma = read_csv("data/velma_ep_ratings.csv")

velma %>% create_episode_plot("Velma") %>% interactive_plotly
```

## Suits

```{r}
suits = read_csv("data/suits_ep_ratings.csv")

suits %>% create_episode_plot("Suits") %>% interactive_plotly
```

## Vampire Diaries

```{r}
vampire_diaries = read_csv("data/vampire_diaries_ep_ratings.csv")

vampire_diaries %>% create_episode_plot("Vampire Diaries") %>% interactive_plotly
```

## Mad Men

```{r}
mad_men = read_csv("data/top250_imdb_series.csv") %>%
  filter(series_name == "Mad Men") %>%
  mutate(season_ep_name = paste0("S", season, "E", season_ep, ": ", episode)) %>%
  select(season_ep_name, episode = season_ep, season,
         imdb_rating = episode_rating) %>%
  filter(episode != 0)

mad_men %>% create_episode_plot("Mad Men") %>% interactive_plotly
```

## Grey's Anatomy

```{r fig.height=9, fig.width=9}
greys_anatomy = read_csv("data/greys_anatomy_ep_ratings.csv")

greys_anatomy %>% create_episode_plot("Grey's Anatomy") %>% interactive_plotly
```

## Friends

```{r fig.height=9, fig.width=9}
friends = read_csv("data/friends_ep_ratings.csv")

friends %>% create_episode_plot("Friends") %>% interactive_plotly
```

[Raw pngs found here](https://github.com/cavandonohoe/cavandonohoe.github.io/tree/main/imdb_rating_plot_files)
